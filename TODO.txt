Rewrite moving functions
Rewrite a lot of things